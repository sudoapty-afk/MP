
name: Windows 10 Chrome Remote Desktop by Akshit

on:
  workflow_dispatch:
    inputs:
      authcode:
        description: 'Chrome Remote Desktop Authorization Code'
        required: true
        default: 'Paste your CRD code here'
      
jobs:
  build:
    runs-on: windows-latest
    timeout-minutes: 9999

    steps:
    - name: Step 1 - Initializing by Akshit
      run: |
        Write-Host "============================================"
        Write-Host "Windows 10 RDP Setup Started by Akshit"
        Write-Host "============================================"
        
    - name: Step 2 - Display System Information by Akshit
      run: |
        Write-Host "Getting System Info by Akshit..."
        Get-ComputerInfo | Select-Object WindowsProductName, WindowsVersion, OsHardwareAbstractionLayer
        Write-Host "Computer Name: $env:COMPUTERNAME"
        Write-Host "Username: $env:USERNAME"
        
    - name: Step 3 - Downloading Chrome Remote Desktop by Akshit
      run: |
        Write-Host "Downloading Chrome Remote Desktop by Akshit..."
        Invoke-WebRequest https://dl.google.com/chrome-remote-desktop/chromeremotedesktophost.msi -OutFile chromeremotedesktophost.msi
        Write-Host "Download Completed by Akshit"
        
    - name: Step 4 - Installing Chrome Remote Desktop by Akshit
      run: |
        Write-Host "Installing Chrome Remote Desktop by Akshit..."
        Start-Process msiexec.exe -ArgumentList '/i chromeremotedesktophost.msi /quiet /norestart' -Wait
        Write-Host "Installation Completed by Akshit"
        Start-Sleep -Seconds 20
        
    - name: Step 5 - Verifying Installation by Akshit
      run: |
        Write-Host "Verifying Chrome Remote Desktop by Akshit..."
        $path = "C:Program Files (x86)GoogleChrome Remote DesktopCurrentVersion
emoting_start_host.exe"
        if (Test-Path $path) {
          Write-Host "Chrome Remote Desktop Successfully Installed by Akshit"
        } else {
          Write-Host "Installation Error - Akshit"
        }
        
    - name: Step 6 - Starting Chrome Remote Desktop Service by Akshit
      run: |
        Write-Host "Starting Chrome Remote Desktop by Akshit..."
        $code = "${{ github.event.inputs.authcode }}"
        $name = "$env:COMPUTERNAME-Akshit"
        & 'C:Program Files (x86)GoogleChrome Remote DesktopCurrentVersion
emoting_start_host.exe' --code="$code" --redirect-url="https://remotedesktop.google.com/_/oauthredirect" --name="$name"
        Write-Host "Chrome Remote Desktop Started by Akshit"
        Start-Sleep -Seconds 10
        
    - name: Step 7 - Enabling RDP by Akshit
      run: |
        Write-Host "Configuring Windows RDP by Akshit..."
        Set-ItemProperty -Path 'HKLM:SystemCurrentControlSetControlTerminal Server' -name "fDenyTSConnections" -Value 0
        Enable-NetFirewallRule -DisplayGroup "Remote Desktop"
        Set-ItemProperty -Path 'HKLM:SystemCurrentControlSetControlTerminal ServerWinStationsRDP-Tcp' -name "UserAuthentication" -Value 1
        Write-Host "RDP Enabled by Akshit"
        
    - name: Step 8 - Setting Up User Password by Akshit
      run: |
        Write-Host "Setting up password by Akshit..."
        net user $env:USERNAME Akshit@2025
        Write-Host "Password configured by Akshit"
        
    - name: Step 9 - Display Connection Information by Akshit
      run: |
        Write-Host ""
        Write-Host "============================================"
        Write-Host "    CONNECTION DETAILS BY AKSHIT"
        Write-Host "============================================"
        Write-Host ""
        Write-Host "Chrome Remote Desktop: ACTIVE"
        Write-Host "Access URL: https://remotedesktop.google.com/access"
        Write-Host "Computer Name: $env:COMPUTERNAME-Akshit"
        Write-Host ""
        Write-Host "RDP Details:"
        Write-Host "Username: $env:USERNAME"
        Write-Host "Password: Akshit@2025"
        Write-Host ""
        Write-Host "Setup Completed by: AKSHIT"
        Write-Host "============================================"
        
    - name: Step 10 - Keep Session Active by Akshit
      run: |
        Write-Host "Maintaining RDP Connection by Akshit..."
        Write-Host "Session will stay active"
        Write-Host "You can access via Chrome Remote Desktop"
        Write-Host "URL: https://remotedesktop.google.com/access"
        Write-Host ""
        $i = 0
        while ($true) {
          Start-Sleep -Seconds 300
          $i++
          $elapsed = $i * 5
          Write-Host "Session Active: $elapsed minutes (Maintained by Akshit)"
        }
